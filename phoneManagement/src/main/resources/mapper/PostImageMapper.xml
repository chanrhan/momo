<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.momo.mapper.PostImageMapper">
    <select id="getPostImageAll">
        select pimg_id as id,
               pimg_text as text,
               pimg_path as path
        from tb_post_img
        where shop_id=#{currShopId}
    </select>

    <insert id="insertPostImage">
        set @next_pimg_id := (
            select IFNULL(max(pimg_id),0)
            from  tb_post_img
            where shop_id=#{currShopId}
            );

        insert into tb_post_img
        (shop_id, pimg_id, pimg_text, pimg_path)
        VALUES (#{currShopId},@next_pimg_id, #{text},#{path})
    </insert>


    <delete id="deletePostImage">
        delete from tb_post_img
        where shop_id=#{currShopId} and
              pimg_id=#{pimgId}
    </delete>

    <delete id="deleteAll">
        delete from tb_post_img
        where shop_id=#{currShopId}
    </delete>
</mapper>