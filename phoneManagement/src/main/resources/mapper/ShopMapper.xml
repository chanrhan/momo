<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.momo.mapper.ShopMapper">
    <select id="search" parameterType="SearchVO">
        with branch as(
            select
                c.reps_id as repsId,
                c.p_ko_nm as p_ko_nm,
                c.p_en_nm as p_en_nm,
                c.corp_nm as corp_nm,
                c.b_no as b_no,
                s.shop_nm as shop_nm,
                s.shop_addr as shop_addr,
                s.shop_tel as shop_tel,
                s.shop_cd as shop_cd
            from
                tb_corp as c
            left outer join tb_shop s on c.b_no = s.b_no
            )

        select
            *
        from
            branch
        where
            ${andSelect} and
            ${orSearch}
        ${prop}
    </select>

    <select id="select">
        select
            *
        from
            tb_shop
        where
            ${qs}
    </select>

    <insert id="insert" parameterMap="ShopCommonVO">
        insert into
            tb_shop
            (shop_cd, shop_nm, shop_addr, shop_tel, b_no)
        values
            (#{shopCd},#{shopNm},#{shopAddr},#{shopTel},#{bNo})
    </insert>

    <update id="update" parameterMap="java.util.Map">
        update
            tb_shop
        set
            shop_nm=#{shop_nm},
            shop_tel=#{shop_tel},
            shop_addr=#{shop_addr},
            b_no=#{b_no}
        where
            shop_cd=#{shop_cd}
    </update>

    <delete id="delete" parameterMap="java.util.Map">
        delete from
            tb_shop
               where
                   shop_cd=#{shop_cd}
    </delete>

    <select id="getMaxCode">
        select
            max(shop_cd)
        from
            tb_shop
    </select>

</mapper>